O(nlog^2n)
O(nlog^2n)
O(nlog^2n)
